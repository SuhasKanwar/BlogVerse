<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include('partials/head') %>
    <link
      href="https://fonts.googleapis.com/css2?family=Inria+Serif:wght@400;700&family=Inter:wght@400;600&family=Inria+Sans:wght@300;400;600&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <link rel="stylesheet" href="/styles/profile.css" />
  </head>
  <body>
    <div class="container">
      <%- include('partials/header') %>
      <div class="profile-container">
        <div class="profile-header">
          <div class="profile-header-content">
            <img
              src="<%= user.profileImageURL || '/images/default-profile.png' %>"
              alt="Profile"
              class="profile-image"
            />
            <div class="profile-info">
              <h1 class="profile-name">
                <%= user.fullName || 'No Name Provided' %>
              </h1>
              <p class="profile-username">
                @<%= user.userName || 'No Username Available' %>
              </p>
              <div class="profile-stats">
                <div class="stat">
                  <span class="stat-number"
                    ><%= blogs ? blogs.length : 0 %></span
                  >
                  <span class="stat-label">Posts</span>
                </div>
                <div class="stat">
                  <span class="stat-number"
                    ><%= comments ? comments.length : 0 %></span
                  >
                  <span class="stat-label">Comments</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <p class="profile-bio">
          <%= user.bio || 'Share a bit about yourself and your journey!' %>
        </p>

        <div class="profile-actions">
          <% if (user && currUser && user._id.toString() ===
          currUser._id.toString()) { %>
          <a href="/profile/edit/<%= currUser._id %>" class="action-link">
            <button class="profile-button" aria-label="Edit Profile">
              <i class="fas fa-user-edit"></i> Edit Profile
            </button>
          </a>
          <% } %>
          <button
            class="profile-button secondary-button"
            aria-label="Share Profile"
          >
            <i class="fas fa-share-nodes"></i> Share Profile
          </button>
          <% if (user && currUser && user._id.toString() ===
          currUser._id.toString()) { %>
          <a href="/login/otp" class="action-link">
            <button
              class="profile-button ternary-button"
              aria-label="Change Password"
            >
              <i class="fas fa-lock"></i> Change Password
            </button>
          </a>
          <% } %>
        </div>

        <div class="profile-tabs">
          <div class="profile-tab active" data-section="about">
            <i class="fas fa-user-circle"></i> About
          </div>
          <div class="profile-tab" data-section="posts">
            <i class="fas fa-blog"></i> Posts
          </div>
          <div class="profile-tab" data-section="comments">
            <i class="fas fa-comment-dots"></i> Comments
          </div>
        </div>

        <div class="section-content active" id="about-section">
          <div class="about-section">
  <div class="about-personal-info">
    <h2>About Me</h2>
    <% if (user.dateOfBirth) { %>
    <div class="about-detail">
      <i class="fas fa-birthday-cake"></i>
      <div class="about-detail-text">
        <strong>Age</strong>
        <span><%= user.age || 'Not Provided' %></span>
      </div>
    </div>
    <% } else { %>
    <p>No date of birth provided.</p>
    <% } %>

    <% if (user.gender) { %>
    <div class="about-detail">
      <i class="fas fa-venus-mars"></i>
      <div class="about-detail-text">
        <strong>Gender</strong>
        <span><%= user.gender %></span>
      </div>
    </div>
    <% } else { %>
    <p>No gender specified.</p>
    <% } %>

    <% if (user.location) { %>
    <div class="about-detail">
      <i class="fas fa-map-marker-alt"></i>
      <div class="about-detail-text">
        <strong>Location</strong>
        <span><%= user.location %></span>
      </div>
    </div>
    <% } else { %>
    <p>Location not specified.</p>
    <% } %>
  </div>

  <div class="social-links">
    <h3><i class="fas fa-share-alt"></i> Connect with Me</h3>
    <div class="social-icons">
      <% if (user.socials && user.socials.linkedin) { %>
      <a
        href="<%= user.socials.linkedin %>"
        target="_blank"
        class="social-icon"
        aria-label="LinkedIn"
      >
        <i class="fab fa-linkedin"></i>
      </a>
      <% } %>
      <!-- Add more social icons here -->
    </div>
  </div>
</div>

        </div>

        <div class="section-content" id="posts-section">
          <div class="user-content">
            <% if (blogs && blogs.length > 0) { %> <% blogs.forEach(blog => { %>
            <div class="content-card">
              <a href="/blog/<%= blog._id %>" class="content-link">
                <div class="content-image-container">
                  <img
                    src="<%= blog.coverImageURL || '/images/default-blog.png' %>"
                    alt="<%= blog.title || 'Untitled Blog' %>"
                  />
                </div>
                <div class="content-text">
                  <h3 class="content-card-title">
                    <%= blog.title || 'Untitled Blog' %>
                  </h3>
                  <p class="content-card-description">
                    <%= blog.body.substring(0, 100) || 'No content available.'
                    %>...
                  </p>
                </div>
              </a>
            </div>
            <% }) %> <% } else { %>
            <p>No blogs to display.</p>
            <% } %>
          </div>
        </div>

        <div class="section-content" id="comments-section">
          <h2>Your Comments</h2>
          <div class="comments-list">
            <% if (comments && comments.length > 0) { %> <%
            comments.forEach(comment => { %>
            <div class="comment">
              <div class="comment-content">
                <p class="comment-text">
                  <strong><%= user.fullName || 'Anonymous' %></strong>: "<%=
                  comment.content || 'No content available.' %>"
                </p>
                <p class="comment-meta">
                  <em
                    >Commented on:
                    <a href="/blog/<%= comment.blogID._id %>"
                      ><%= comment.blogID.title || 'Untitled Blog' %></a
                    >
                  </em>
                </p>
              </div>
            </div>
            <% }) %> <% } else { %>
            <p>No comments to display.</p>
            <% } %>
          </div>
        </div>
      </div>
      <%- include('partials/footer') %>
    </div>
    <script src="/profile.js"></script>
  </body>
</html>