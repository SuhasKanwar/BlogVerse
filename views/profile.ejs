<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include('partials/head') %>
    <link href="https://fonts.googleapis.com/css2?family=Inria+Serif:wght@400;700&family=Inter:wght@400;600&family=Inria+Sans:wght@300;400;600&display=swap" rel="stylesheet"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"/>
    <link rel="stylesheet" href="/styles/profile.css" />
  </head>
  <body>
    <div class="container">
        <%- include('partials/header') %>
      <div class="profile-container">
        <div class="profile-header">
          <img
            src="<%= user.profileImageURL %>"
            alt="Profile"
            class="profile-image"
          />
          <div class="profile-info">
            <h1 class="profile-name"><%= user.fullName %></h1>
            <p class="profile-username">@<%= user.email.split('@')[0] %></p>
            <div class="profile-stats">
              <div class="stat">
                <span class="stat-number"><%= blogs.length %></span>
                <span class="stat-label">Posts</span>
              </div>
            </div>
          </div>
        </div>

        <p class="profile-bio">
          <%= user.bio || 'Tell us something about yourself!' %>
        </p>

        <div class="profile-actions">
          <% if (user._id.toString() === currUser._id.toString()) { %>
            <a href="/profile/edit/<%= currUser._id %>">
              <button class="profile-button">
                <i class="fas fa-edit"></i> Edit Profile
              </button>
            </a>
          <% } %>
          <button class="profile-button secondary-button">
            <i class="fas fa-share-alt"></i> Share Profile
          </button>
          <% if (user._id.toString() === currUser._id.toString()) { %>
            <a href="/login/otp">
              <button class="profile-button ternary-button">
                <i class="fas fa-edit"></i> Change Password
              </button>
            </a>
          <% } %>
        </div>        

        <div class="profile-tabs">
            <div class="profile-tab active" data-section="about">About</div>
            <div class="profile-tab" data-section="posts">Posts</div>
            <div class="profile-tab" data-section="comments">Comments</div>
        </div>

        <div class="section-content active" id="about-section">
          <div class="about-section">
            <h2>About Me</h2>
            <p><%= user.bio || 'Hi, I\'m a passionate tech enthusiast, and I write about technology, creativity, and innovation.' %></p>
          </div>
        </div>

        <div class="section-content" id="posts-section">
          <div class="user-content">
            <% blogs.forEach(blog => { %>
              <div class="content-card">
                <a href="/blog/<%= blog._id %>">
                  <img src="<%= blog.coverImageURL %>" alt="<%= blog.title %>" />
                  <h3 class="content-card-title"><%= blog.title %></h3>
                  <p class="content-card-description"><%= blog.body.substring(0, 100) %>...</p>
                </a>
              </div>
            <% }) %>
          </div>
        </div>

        <div class="section-content" id="comments-section">
          <h2>Your Comments on Blogs</h2>
          <div class="comments-list">
            <% comments.forEach(comment => { %>
              <div class="comment">
                <p><strong><%= user.fullName %></strong>: "<%= comment.content %>"</p>
                <p><em>Commented on: 
                  <a href="/blog/<%= comment.blogID._id %>"><%= comment.blogID.title %></a>
                </em></p>
              </div>
            <% }) %>
          </div>
        </div>

      </div>
      <%- include('partials/footer') %>
    </div>
    <script src="/profile.js"></script>
  </body>
</html>